COMPLETE CSV FILES DOWNLOAD FLOW DOCUMENTATION
=====================================================

üî• WIFI AUTOMATION SYSTEM - CSV DOWNLOAD FLOW
=====================================================

OVERVIEW:
--------
This document describes the complete flow for downloading CSV files from the WiFi management system.
The system downloads client data from 4 wireless networks across 2 pages.

SYSTEM INITIALIZATION:
---------------------
1. üöÄ Initialize WiFi App
   - Setup dynamic file manager (EHC_Data/DDmmmm format)
   - Initialize logging system (EHC_Logs with 7-day cleanup)
   - Setup email notifications

2. üîß Chrome Setup
   - Configure Chrome with iframe support
   - Set download directory to EHC_Data/07jul (dynamic)
   - Enable SSL certificate handling
   - Maximize window for stability

LOGIN PROCESS:
--------------
3. üåê Navigate to Target URL
   - URL: https://51.38.163.73:8443/wsg/
   - Wait 10 seconds for page load
   - Take screenshot for debugging

4. üîç Find and Switch to iframe
   - Look for maskFrame iframe (id="maskFrame")
   - Switch to iframe context
   - Wait 5 seconds for iframe to load

5. üîë Enter Credentials
   - Find visible input fields in iframe
   - Enter username: "admin"
   - Enter password: "AdminFlower@123"
   - Wait 1 second between entries

6. üñ±Ô∏è Click Login Button
   - Find login button (button or input[type='submit'])
   - Click login button
   - Wait 15 seconds for login completion (OPTIMIZED from 30)
   - Switch back to default content

NAVIGATION PROCESS:
------------------
7. üß≠ Navigate to Wireless LANs
   - Wait 8 seconds for page stabilization
   - Take screenshot for debugging
   - Find Wireless LANs menu using selectors:
     * //div[contains(@class, 'x-title-text')][contains(text(), 'Wireless LANs')]
     * //div[@id='title-1343-textEl']
     * //div[contains(text(), 'Wireless LANs')]
     * //span[contains(text(), 'Wireless LANs')]
   - Click Wireless LANs menu
   - Wait 5 seconds for menu to load

8. üìã Click List Button (NEW ENHANCEMENT)
   - Find List button using selectors:
     * //span[@id='button-1644-btnInnerEl']
     * //*[@id='button-1644-btnInnerEl']
     * //span[@data-ref='btnInnerEl'][contains(text(), 'List')]
     * //span[contains(@class, 'x-btn-inner')][contains(text(), 'List')]
   - Click List button to ensure all networks are visible
   - Wait 3 seconds for list view to load

DOWNLOAD PROCESS - PAGE 1:
--------------------------
9. üì° Download from EHC TV (with Clients tab)
   - Find network: //span[contains(@class, 'rks-clickable-column')][contains(text(), 'EHC TV')]
   - Click EHC TV network
   - Wait 3 seconds
   - Find Clients tab: //span[@id='tab-3060-btnInnerEl'] or //span[contains(@class, 'x-tab-inner')][contains(text(), 'Clients')]
   - Click Clients tab
   - Wait 3 seconds
   - Find download button: //span[@id='Rks-module-base-Button-3369-btnIconEl'] or //span[contains(@class, 'x-btn-glyph')][@style*='FontAwesome']
   - Click download button
   - Wait 5 seconds for download
   - SUCCESS: Downloaded clients.csv (or clients (n).csv)

10. üì° Download from EHC-15 (direct download)
    - Find network: //span[contains(@class, 'rks-clickable-column')][contains(text(), 'EHC-15')]
    - Click EHC-15 network
    - Wait 3 seconds
    - Find download button (no Clients tab needed)
    - Click download button
    - Wait 5 seconds for download
    - SUCCESS: Downloaded clients (n).csv

NAVIGATION TO PAGE 2:
--------------------
11. üìÑ Navigate to Page 2
    - Find page 2 button: //span[@id='button-2436-btnInnerEl'] or //span[contains(@class, 'x-btn-inner')][contains(text(), '2')]
    - Click page 2 button
    - Wait 5 seconds for page to load

DOWNLOAD PROCESS - PAGE 2:
--------------------------
12. üì° Download from Reception Hall-Mobile (with Clients tab)
    - Find network: //span[contains(@class, 'rks-clickable-column')][contains(text(), 'Reception Hall-Mobile')]
    - Click Reception Hall-Mobile network
    - Wait 3 seconds
    - Find and click Clients tab
    - Wait 3 seconds
    - Find and click download button
    - Wait 5 seconds for download
    - SUCCESS: Downloaded clients (n).csv

13. üì° Download from Reception Hall-TV (Clients tab vanishes)
    - Find network: //span[contains(@class, 'rks-clickable-column')][contains(text(), 'Reception Hall-TV')]
    - Click Reception Hall-TV network
    - Wait 3 seconds
    - Find download button (Clients tab automatically disappears)
    - Click download button
    - Wait 5 seconds for download
    - SUCCESS: Downloaded clients (n).csv

COMPLETION PROCESS:
------------------
14. ‚è≥ Wait for Downloads
    - Wait 10 seconds for all downloads to complete
    - Check download directory for new files

15. üìä Final Results Analysis
    - Count initial CSV files
    - Count final CSV files
    - Calculate new files downloaded
    - Display success statistics

16. üìß Send Email Notification
    - Send success email to faseenm@gmail.com
    - Include download count and timestamp
    - Subject: "‚úÖ CSV Download Success - Robust - MM/DD/YYYY"

17. üîÑ Cleanup
    - Keep Chrome open for 15 seconds for inspection
    - Close Chrome browser
    - Display final success message

EXPECTED RESULTS:
----------------
- 4 Networks processed: EHC TV, EHC-15, Reception Hall-Mobile, Reception Hall-TV
- 4 New CSV files downloaded
- Files saved to: EHC_Data/07jul/ (dynamic date folder)
- Email notification sent
- Total process time: ~2-3 minutes

FILE NAMING PATTERN:
-------------------
- clients.csv (first download)
- clients (1).csv (second download)
- clients (2).csv (third download)
- clients (3).csv (fourth download)
- etc.

ERROR HANDLING:
--------------
- Login retry with page refresh (up to 3 attempts)
- Navigation retry with page refresh (up to 3 attempts)
- Individual network download failures logged but don't stop process
- Chrome crash detection and recovery
- Screenshot capture for debugging

PERFORMANCE OPTIMIZATIONS:
-------------------------
- Reduced login wait from 30 to 15 seconds
- Added List button click for better network visibility
- Precise selectors to avoid unwanted clicks
- Stable Chrome configuration to prevent crashes
- Efficient wait times between operations

SUCCESS CRITERIA:
----------------
‚úÖ All 4 networks found and clicked
‚úÖ All 4 download buttons found and clicked
‚úÖ All 4 CSV files downloaded successfully
‚úÖ Email notification sent
‚úÖ No Chrome crashes or session losses
‚úÖ Process completes in under 3 minutes

TECHNICAL DETAILS:
-----------------
- Framework: Selenium WebDriver with Chrome
- Language: Python 3.x
- Timeout: 30 seconds for element waits
- Screenshots: Saved for debugging at key points
- Logging: Comprehensive logging with timestamps
- Email: SMTP integration for notifications

=====================================================
END OF CSV DOWNLOAD FLOW DOCUMENTATION
===================================================== 